<!doctype html>
<html>

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel= "stylesheet" href= "list.css">

<style>
  @import url(list.css);
  @import url(1122.css);
</style>
<title> Things To Do </title>
<style>
input[type="text"] {
  padding: 8px;
  width: 70%;
  border: 1px solid #ddd;
  border-radius: 5px;

}
button {
  padding: 8px 15px;
  margin-top: 10px;
  background-color: #5a9978;
  color: white;
  border: none;
  cursor: pointer;
  font-size: 16px;
  border-radius: 5px;
}
button:hover {
  background-color: #4a8766;
}


</style>
</head>

<body>

  <div class="header">
    <h1> Our Bucket List ✅  </h1>
    <a href="Favourite.html"><img class="myimage" src="favourite.png" alt="homepage" ></a>
    <a href="About us.html"><img class="myimage" src="relationship.png" alt="homepage" ></a>
    <a href="adventure.html"><img class="myimage" src="home.png" alt="homepage"></a>
    <br>
    <Br>
    </div>

  <div class="box">
    <div class="container"><input type="text" id="newTask" placeholder="Enter new bucket list">
      <button onclick="addTask()">Add</button></div>


    <form id="bucketList">
    </form>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
        const bucketList = document.getElementById("bucketList");

        // ✅ Load checked & disabled tasks from localStorage
        const checkedTasks = JSON.parse(localStorage.getItem("checkedTasks")) || [];
        const disabledTasks = JSON.parse(localStorage.getItem("disabledTasks")) || [];

        let tasks = JSON.parse(localStorage.getItem("bucketList")) || [];

        tasks.forEach(task => {
            addTaskToDOM(task.text, task.checked, task.disabled);
        });

        // ✅ Restore checked & disabled states
        checkedTasks.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) checkbox.checked = true;
        });

        disabledTasks.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) checkbox.disabled = true;
        });

        // ✅ Listen for checkbox changes
        bucketList.addEventListener("change", function (e) {
            if (e.target.type === "checkbox") {
                updateTaskStates();
            }
        });
    });

    function addTask() {
        const taskInput = document.getElementById("newTask");
        const taskText = taskInput.value.trim();
        if (!taskText) return;

        if (isTaskDuplicate(taskText)) {
            alert("This task already exists in the list!");
            return;
        }

        addTaskToDOM(taskText);
        saveNewTask(taskText, false, false);
        taskInput.value = "";

    }

    function isTaskDuplicate(text) {
        return [...document.querySelectorAll("#bucketList label")].some(label => label.innerText.toLowerCase() === text.toLowerCase());
    }

    function saveNewTask(text, checked, disabled) {
        let tasks = JSON.parse(localStorage.getItem("bucketList")) || [];
        tasks.push({ text: text, checked: checked, disabled: disabled });
        localStorage.setItem("bucketList", JSON.stringify(tasks));
    }

    function addTaskToDOM(text) {
        const bucketList = document.getElementById("bucketList");
        const newId = "list" + (document.querySelectorAll('input[type="checkbox"]').length + 1);

        bucketList.insertAdjacentHTML("beforeend", `
            <div>
                <input type="checkbox" id="${newId}">
                <label for="${newId}">${text}</label>
            </div>
        `);
    }

    function updateTaskStates() {
        let checkedTasks = [];
        let disabledTasks = [];
        let tasks = [];

        document.querySelectorAll("#bucketList input[type='checkbox']").forEach(checkbox => {
            if (checkbox.checked) {
                checkedTasks.push(checkbox.id);
                checkbox.disabled = true;
                disabledTasks.push(checkbox.id);
            }
        });
        document.querySelectorAll("#bucketList div").forEach(div => {
            const checkbox = div.querySelector("input[type='checkbox']");
            const label = div.querySelector("label");
            tasks.push({ text: label.innerText, checked: checkbox.checked, disabled: checkbox.disabled });

            if (checkbox.checked) {
                checkbox.disabled = true;  // Disable checked tasks
            }
        });

        localStorage.setItem("bucketList", JSON.stringify(tasks));
        localStorage.setItem("checkedTasks", JSON.stringify(checkedTasks));
        localStorage.setItem("disabledTasks", JSON.stringify(disabledTasks));
    }
  </script>
<a style="display:scroll;position:fixed;bottom:10px;right:10px;" href="#" title="Top">Go to Top</a>
</body>


</html>
